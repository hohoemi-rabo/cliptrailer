# 05. 画像生成（Step③）

## 概要

台本に基づいて4枚のAI画像を生成する。

## 完了条件

- 台本から4枚の画像が自動生成される
- 各画像の再生成ができる
- ユーザーの画像をアップロードして差し替えができる

## 技術仕様

| 項目 | 内容 |
|------|------|
| 生成API | NanoBananaPro（gemini-3-pro-image-preview） |
| 枚数 | 4枚固定（MVP） |
| 画像サイズ | 1080×1920（縦動画用） |
| 再生成 | 回数制限なし（MVP） |

## タスク

- [x] 画像生成API連携（Imagen 3）
- [x] 4枚同時生成の実装
- [x] 画像プレビュー表示
- [x] 個別画像の再生成機能
- [x] 画像アップロード・差し替え機能
- [x] 生成中のローディング表示
- [x] 生成失敗時の再生成ボタン表示
- [ ] 画像の順序入れ替え機能（オプション）
- [ ] Supabase Storageへの画像保存

## UI設計

```
┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐
│ 1   │ │ 2   │ │ 3   │ │ 4   │
│     │ │     │ │     │ │     │
├─────┤ ├─────┤ ├─────┤ ├─────┤
│再生成│ │再生成│ │再生成│ │再生成│
│差替え│ │差替え│ │差替え│ │差替え│
└─────┘ └─────┘ └─────┘ └─────┘
```

## データ構造

```typescript
interface GeneratedImage {
  id: string
  index: number // 0-3
  url: string
  prompt: string
  isUserUploaded: boolean
  createdAt: Date
}
```

## 画像生成プロンプト設計

- 台本の各セクションに対応した画像
- 統一感のあるスタイル
- 縦動画に適した構図
